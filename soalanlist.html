<!doctype html>
<html lang="en">

<head>
    <title>:: CCS :: Set Soalan</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="description" content="CCS Bootstrap 4.1.1 Admin Template">
    <meta name="author" content="ThemeMakker, design by: ThemeMakker.com">

    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- VENDOR CSS -->
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/vendor/animate-css/animate.min.css">
    <link rel="stylesheet" href="../assets/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap-multiselect/bootstrap-multiselect.css">
    <link rel="stylesheet" href="../assets/vendor/parsleyjs/css/parsley.css">

    <!-- MAIN CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/color_skins.css">
</head>
<body class="theme-blue">

<!-- Page Loader -->
<div class="page-loader-wrapper">
    <div class="loader">
        <div class="m-t-30"><img src="../assets/images/thumbnail.png" width="48" height="48" alt="CCS"></div>
        <p>Please wait...</p>
    </div>
</div>
<!-- Overlay For Sidebars -->
<div class="overlay" style="display: none;"></div>

<div id="wrapper">

    <nav class="navbar navbar-fixed-top">
        <div class="container-fluid">

            <div class="navbar-brand">
                <a href="index.html">
                    <img src="../assets/images/logo.png" alt="CCS Logo" class="img-responsive logo">
                    <span class="name">CCS</span>
                </a>
            </div>

            <div class="navbar-right">
                <ul class="list-unstyled clearfix mb-0">
                    <li>
                        <div class="navbar-btn btn-toggle-show">
                            <button type="button" class="btn-toggle-offcanvas"><i class="lnr lnr-menu fa fa-bars"></i>
                            </button>
                        </div>
                        <a href="javascript:void(0);" class="btn-toggle-fullwidth btn-toggle-hide"><i
                                class="fa fa-bars"></i></a>
                    </li>
                    <li>
                        <form id="navbar-search" class="navbar-form search-form">
                            <input value="" class="form-control" placeholder="Search here..." type="text">
                            <button type="button" class="btn btn-default"><i class="icon-magnifier"></i></button>
                        </form>
                    </li>
                    <li>
                        <div id="navbar-menu">
                            <ul class="nav navbar-nav">
                                <li>
                                    <a href="javascript:void(0);" class="mega_menu icon-menu" title="Mega Menu">Menu</a>
                                </li>
                                <li>
                                    <a href="javascript:void(0);" class="create_new icon-menu" title="Create New">Refresh</a>
                                </li>
                                <li class="dropdown">
                                    <a href="javascript:void(0);" class="dropdown-toggle icon-menu"
                                       data-toggle="dropdown">
                                        <i class="icon-bell"></i>
                                        <span class="notification-dot"></span>
                                    </a>

                                </li>
                                <li class="dropdown">
                                    <a href="javascript:void(0);" class="dropdown-toggle icon-menu"
                                       data-toggle="dropdown"><i class="icon-flag"></i><span
                                            class="notification-dot"></span></a>
                                    <ul class="dropdown-menu animated bounceIn task">
                                        <li class="header"><strong>Kawasan Terbaru</strong></li>
                                        <li class="body">
                                            <ul class="menu tasks list-unstyled">
                                                <li>
                                                    <a href="javascript:void(0);">
                                                        <span class="text-muted">Selayang <span
                                                                class="float-right">29%</span></span>
                                                        <div class="progress">
                                                            <div class="progress-bar l-turquoise" role="progressbar"
                                                                 aria-valuenow="29" aria-valuemin="0"
                                                                 aria-valuemax="100" style="width: 29%;"></div>
                                                        </div>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:void(0);">
                                                        <span class="text-muted">Batu Muda <span
                                                                class="float-right">78%</span></span>
                                                        <div class="progress">
                                                            <div class="progress-bar l-slategray" role="progressbar"
                                                                 aria-valuenow="78" aria-valuemin="0"
                                                                 aria-valuemax="100" style="width: 78%;"></div>
                                                        </div>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:void(0);">
                                                        <span class="text-muted">Ampang Baru <span class="float-right">45%</span></span>
                                                        <div class="progress">
                                                            <div class="progress-bar l-parpl" role="progressbar"
                                                                 aria-valuenow="45" aria-valuemin="0"
                                                                 aria-valuemax="100" style="width: 45%;"></div>
                                                        </div>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:void(0);">
                                                        <span class="text-muted">Sri Gombak <span class="float-right">68%</span></span>
                                                        <div class="progress">
                                                            <div class="progress-bar l-coral" role="progressbar"
                                                                 aria-valuenow="68" aria-valuemin="0"
                                                                 aria-valuemax="100" style="width: 68%;"></div>
                                                        </div>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="javascript:void(0);">
                                                        <span class="text-muted">Kota Damansara <span
                                                                class="float-right">21%</span></span>
                                                        <div class="progress">
                                                            <div class="progress-bar l-amber" role="progressbar"
                                                                 aria-valuenow="21" aria-valuemin="0"
                                                                 aria-valuemax="100" style="width: 21%;"></div>
                                                        </div>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>
                                        <li class="footer"><a href="javascript:void(0);">View All</a></li>
                                    </ul>
                                </li>
                                <li class="dropdown">
                                    <a href="javascript:void(0);" class="dropdown-toggle icon-menu"
                                       data-toggle="dropdown"><i class="fa fa-language"></i></a>
                                    <ul class="dropdown-menu animated flipInX choose_language">
                                        <li><a href="javascript:void(0);">English</a></li>
                                        <li><a href="javascript:void(0);">Malay</a></li>
                                        <li><a href="javascript:void(0);">Chinese</a></li>
                                        <li><a href="javascript:void(0);">Indian</a></li>
                                    </ul>
                                </li>
                                <li class="dropdown">
                                    <a href="javascript:void(0);" class="dropdown-toggle icon-menu"
                                       data-toggle="dropdown">
                                        <img class="rounded-circle" src="../assets/images/user-small.png" width="30"
                                             alt="">
                                    </a>
                                    <div class="dropdown-menu animated flipInY user-profile">
                                        <div class="d-flex p-3 align-items-center">
                                            <div class="drop-left m-r-10">
                                                <img src="../assets/images/user-small.png" class="rounded" width="50"
                                                     alt="">
                                            </div>
                                            <div class="drop-right">
                                                <h4>Diana Osman</h4>
                                                <p class="user-name">dianaosman@info.com</p>
                                            </div>
                                        </div>
                                        <div class="m-t-10 p-3 drop-list">
                                            <ul class="list-unstyled">
                                                <li><a href="page-profile.html"><i class="icon-user"></i>My Profile</a>
                                                </li>
                                                <li><a href="app-inbox.html"><i class="icon-envelope-open"></i>Messages</a>
                                                </li>
                                                <li><a href="javascript:void(0);"><i class="icon-settings"></i>Settings</a>
                                                </li>
                                                <li class="divider"></li>
                                                <li><a href="page-login.html"><i class="icon-power"></i>Logout</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div id="leftsidebar" class="sidebar">
        <div class="sidebar-scroll">
            <nav id="leftsidebar-nav" class="sidebar-nav">
                <ul id="main-menu" class="metismenu">
                    <li class="heading">Main</li>
                    <li><a href="index.html"><i class="icon-home"></i><span>Dashboard</span></a></li>
                    <li class="heading">App</li>
                    <li><a href="#"><i class="icon-envelope"></i><span>Inbox</span></a></li>
                    <li><a href="#"><i class="icon-calendar"></i><span>Calendar</span></a></li>
                    <li><a href="#"><i class="icon-notebook"></i><span>Taskboard</span></a></li>
                    <li class="heading">Tetapan</li>
                    <li class="middle">
                        <a href="#Tetapan" class="has-arrow"><i class="icon-user"></i><span>User</span></a>
                        <ul>
                            <li><a href="useradmin.html">Admin</a></li>
                            <li><a href="usersuper.html">Supervisor</a></li>
                            <li><a href="useroperator.html">Operator</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="#Widgets" class="has-arrow"><i class="icon-puzzle"></i><span>Record Operator</span></a>
                        <ul>
                            <li><a href="opstats.html">Statistics</a></li>
                            <li><a href="opkawasan.html">Tetapan Kawasan</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="uploadsasaran.html"><i class="icon-cloud-upload"></i><span>Upload Sasaran</span></a>
                    </li>
                    <li class="heading">Kajiselidik</li>
                    <li>
                        <a href="soalanresult.html"><i class="icon-bar-chart"></i><span>Result</span></a>
                    </li>
                    <li class="active">
                        <a href="#soalan" class="has-arrow"><i class="icon-pencil"></i><span>Soalan</span></a>
                        <ul>
                            <li><a href="soalanlist.html">Senarai Set Soalan</a></li>
                            <li><a href="soalantambah.html">Tambah Set Soalan</a></li>

                        </ul>
                    </li>

                    <li>
                        <a href="#komen" class="has-arrow"><i class="icon-tag"></i><span>Comment</span></a>
                        <ul>
                            <li><a href="#">Custom Categories</a></li>
                            <li><a href="#">Comments List</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </div>


    <div id="main-content">
        <div class="container-fluid">
            <div class="block-header">
                <div class="row">
                    <div class="col-lg-5 col-md-8 col-sm-12">
                        <h2>Senarai Soalan</h2>
                    </div>
                    <div class="col-lg-7 col-md-4 col-sm-12 text-right">
                        <ul class="breadcrumb justify-content-end">
                            <li class="breadcrumb-item"><a href="index.html"><i class="icon-home"></i></a></li>
                            <li class="breadcrumb-item">Soalan</li>
                            <li class="breadcrumb-item active">Senarai Soalan</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="col-md-12">
                <div class="card">
                    <div class="header">
                        <h2>Senarai Soalan</h2>
                    </div>
                    <div class="body">
                        <div class="table-responsive">
                            <table class="table center-aligned-table">
                                <thead>
                                <tr>
                                    <th>Set #</th>
                                    <th>Nama Set</th>
                                    <th>Date created</th>
                                    <th>Bilangan Soalan</th>
                                    <th>Kategori</th>
                                    <th>Status</th>
                                    <th></th>
                                    <th></th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr v-for="s,i in set">
                                    <td>{{s.name}}</td>
                                    <td>{{s.category}}</td>
                                    <td>{{s.date_created}}</td>
                                    <td>{{s.questions.length}}</td>
                                    <td>{{s.category}}</td>
                                    <td><label class="badge">Active</label></td>
                                    <td>
                                        <button @click="viewQuestionsModal(i)" class="btn btn-success btn-sm">View Set
                                        </button>
                                    </td>
                                    <td>
                                        <button @click="editSetModal(i)" class="btn btn-info btn-sm"><i class="icon-pencil"></i></button>
                                    </td>
                                    <td>
                                        <button @click="deleteSet(i)" class="btn btn-danger btn-sm"><i class="icon-trash"></i></button>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>


        </div>
        <div class="modal" tabindex="-1" id="editQuestionsModal" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Question List</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <textarea class="form-control" v-for="q,index in questions" v-model="questions[index].question" aria-label="With textarea"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button @click="editSet" type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" tabindex="-1" id="questionsModal" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Question List</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p v-for="q in questions">{{q.question}}</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<!-- Javascript -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/@directus/sdk-js@4.0.0/dist/directus-sdk.umd.min.js"></script>

<script src="assets/bundles/libscripts.bundle.js"></script>
<script src="assets/bundles/vendorscripts.bundle.js"></script>

<script src="assets/bundles/mainscripts.bundle.js"></script>
<script src="assets/bundles/morrisscripts.bundle.js"></script>
<script>
    const client = new DirectusSDK({
        url: "http://ccs.cyrix.my/cms/public",
    });
    let set = [];
    client.getItems("set_soalan", {
        fields: "*.*"
    }).then(res => {
        app.set = res.data;
        console.log(res.data)
    });
    let app = new Vue({
        el: '#main-content',
        data: {
            set: [],
            questions: [],
            currentSet: 0,
        },
        computed: {
            /*set : async function(){
                const data = await client.getItems("movies");
                return data;
            }*/
        },
        methods: {
            viewQuestionsModal: function (i) {
                this.questions = this.set[i].questions;
                $('#questionsModal').modal();
            },
            editSetModal: function(i){
                this.currentSet = i;
                this.questions = this.set[i].questions;
                $('#editQuestionsModal').modal();
            },
            editSet: function(){
                let qId = this.set[this.currentSet].questions.map((a) => {
                    return a.id;
                });
                console.log(qId);
                //return;
                client.updateItems("soalan", [
                    { id: qId[0], question: this.questions[0].question },
                    { id: qId[1], question: this.questions[1].question },
                    { id: qId[2], question: this.questions[2].question }
                ]);
            },
            deleteSet: function(i){
                let qId = this.set[i].questions.map((a) => {
                    return a.id;
                });
                console.log(qId);
                client.deleteItems("soalan", qId);
                client.deleteItem("set_soalan", this.set[i].id);
                this.set.splice(i, 1);
            }
        }
    });
</script>
</body>
</html>


